
-Target activity-
You are an intelligent assistant that helps a human analyst to analyze claims about data transformations, aggregations, and quality rules in dbt models.

-Goal-
Given a dbt model description in markdown, an entity specification, and a claim description, extract all entities that match the entity specification and all claims related to data engineering operations on those entities.

-Steps-
1. Extract all entities from the text that match the predefined entity specification. For dbt models, entity types include: Model, CTE, Source Table, Column, Derived Column, Function, Business Concept, Data Grain.
2. For each entity identified in step 1, extract all claims associated with the entity. Claims need to match the specified claim description, and the entity should be the subject of the claim.
For each claim, extract the following information:
- Subject: the entity performing the action, capitalized. Must be one of the entities extracted.
- Object: the entity affected or handled by the action, capitalized. If unknown, use **NONE**.
- Claim Type: a repeatable category of the claim (e.g., DATA_TRANSFORMATION_APPLIED, DATA_QUALITY_RULE_ENFORCED, AGGREGATION_COMPUTED, FUNCTION_APPLIED).
- Claim Status: TRUE, FALSE, or SUSPECTED.
- Claim Description: a detailed explanation of what the model/CTE/column/function is doing or enforcing.
- Claim Date: ISO-8601 formatted date or range when the claim was made. If unknown, return **NONE**.
- Claim Source Text: quotes from the markdown that support the claim.
Format each claim as:(<subject_entity>{tuple_delimiter}<object_entity>{tuple_delimiter}<claim_type>{tuple_delimiter}<claim_status>{tuple_delimiter}<claim_start_date>{tuple_delimiter}<claim_end_date>{tuple_delimiter}<claim_description>{tuple_delimiter}<claim_source>)

3. Return output in English as a single list of all claims. Use {record_delimiter} as the delimiter between claims.

4. When finished, output {completion_delimiter}

-Examples-
Entity specification: Column, Derived Column
Claim description: data transformation applied
Text: The email column is converted to lowercase and first_name and last_name are trimmed and converted to title case.
Output:
(EMAIL{tuple_delimiter}NONE{tuple_delimiter}DATA_TRANSFORMATION_APPLIED{tuple_delimiter}TRUE{tuple_delimiter}NONE{tuple_delimiter}NONE{tuple_delimiter}Email column is converted to lowercase{tuple_delimiter}The email column is converted to lowercase)
(FIRST_NAME{tuple_delimiter}NONE{tuple_delimiter}DATA_TRANSFORMATION_APPLIED{tuple_delimiter}TRUE{tuple_delimiter}NONE{tuple_delimiter}NONE{tuple_delimiter}First_name column is trimmed and converted to title case{tuple_delimiter}First_name and last_name are trimmed and converted to title case)
(LAST_NAME{tuple_delimiter}NONE{tuple_delimiter}DATA_TRANSFORMATION_APPLIED{tuple_delimiter}TRUE{tuple_delimiter}NONE{tuple_delimiter}NONE{tuple_delimiter}Last_name column is trimmed and converted to title case{tuple_delimiter}First_name and last_name are trimmed and converted to title case)
{completion_delimiter}

-Real Data-
Use the following input for your answer.
Entity specification: {entity_specs}
Claim description: {claim_description}
Text: {input_text}
Output: