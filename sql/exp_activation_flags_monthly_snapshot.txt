## Table Name: REPORTING_DEV.DBT_MAHMUDNABI_gtm_analytics.exp_activation_flags_monthly_snapshot

## Overview
Creates a daily snapshot of the `exp_activation_flags` table by adding a unique identifier per account per day and a snapshot timestamp, then returns all columns.

## Tables Involved
- REPORTING_DEV.DBT_MAHMUDNABI_gtm_analytics.exp_activation_flags: source table containing activation flags.

## Columns Used
- REPORTING_DEV.DBT_MAHMUDNABI_gtm_analytics.exp_activation_flags:
  - Not inferable from provided SQL.
  - REPORTING_DEV.DBT_MAHMUDNABI_gtm_analytics.exp_activation_flags.id – hash of `salesforce_account_id` and current date, used as a unique identifier per account per day.
  - REPORTING_DEV.DBT_MAHMUDNABI_gtm_analytics.exp_activation_flags.snapshot_date – current date, indicating the snapshot timestamp.

## Logic Explanation
1. **CTE `dated_exp_activation_flags`**  
   - Selects all columns from `REPORTING_DEV.DBT_MAHMUDNABI_gtm_analytics.exp_activation_flags`.  
   - Adds two derived columns:  
     - `id`: `HASH(salesforce_account_id, CURRENT_DATE())`, providing a unique key per account per day.  
     - `snapshot_date`: `CURRENT_DATE()`, marking the snapshot date.  
   - No filters, joins, or aggregations are applied within the CTE.

2. **Final SELECT**  
   - Retrieves all columns from the CTE, effectively returning the original table data plus the two new columns.

No ordering, limiting, or additional transformations are present.

## Grain of Data
Row-level granularity identical to the source table, with each row representing a unique `salesforce_account_id` for the current date.
