## Table Name: REPORTING_DEV.DBT_MAHMUDNABI_gtm_analytics.qualified_lead_snapshot

## Overview  
This query retrieves a complete snapshot of qualified leads from Salesforce, including metadata, status dates, and SCD tracking fields, for use in downstream analytics and reporting.

## Tables Involved  
- **TRANSFORM_DEV.DBT_MAHMUDNABI_snapshots.sfdc_qualified_lead_snapshot**: Snapshot table containing all fields for qualified leads.

## Columns Used  
**TRANSFORM_DEV.DBT_MAHMUDNABI_snapshots.sfdc_qualified_lead_snapshot:**  
- `ID` – Unique identifier of the lead record.  
- `OWNER_ID` – Identifier of the owner user.  
- `IS_DELETED` – Flag indicating if the record is deleted.  
- `NAME` – Lead name.  
- `CURRENCY_ISO_CODE` – Currency code for monetary fields.  
- `CREATED_DATE` – Timestamp when the record was created.  
- `CREATED_BY_ID` – Identifier of the user who created the record.  
- `LAST_MODIFIED_DATE` – Timestamp of the last modification.  
- `LAST_MODIFIED_BY_ID` – Identifier of the user who last modified the record.  
- `SYSTEM_MODSTAMP` – System modification stamp.  
- `LAST_ACTIVITY_DATE` – Date of last activity.  
- `LAST_VIEWED_DATE` – Date the record was last viewed.  
- `LAST_REFERENCED_DATE` – Date the record was last referenced.  
- `CONTACT_C` – Count of contacts associated with the lead.  
- `LEAD_C` – Count of leads associated with the lead.  
- `MQL_CAMPAIGN_C` – Count of MQL campaigns.  
- `MQL_CHANNEL_CATEGORY_C` – Count of MQL channel categories.  
- `MQL_CHANNEL_C` – Count of MQL channels.  
- `OPPORTUNITY_C` – Count of opportunities linked to the lead.  
- `STATUS_C` – Current status of the lead.  
- `TYPE_OF_MQL_C` – Type of MQL.  
- `PARENT_ACCOUNT_C` – Identifier of the parent account.  
- `PARTNER_LEAD_STATUS_C` – Status of the partner lead.  
- `IS_ACTIVE_C` – Flag indicating if the lead is active.  
- `MARKETING_FUNNEL_STAGE_C` – Current stage in the marketing funnel.  
- `DATE_STATUS_NEW_C` – Date when status changed to New.  
- `DATE_STATUS_ENGAGED_C` – Date when status changed to Engaged.  
- `DATE_STATUS_QUALIFIED_C` – Date when status changed to Qualified.  
- `DATE_STATUS_SPL_C` – Date when status changed to SPL.  
- `DATE_STATUS_SAL_C` – Date when status changed to SAL.  
- `DATE_STATUS_OPPORTUNITY_C` – Date when status changed to Opportunity.  
- `DATE_STATUS_RECYCLED_C` – Date when status changed to Recycled.  
- `DATE_STATUS_DISQUALIFIED_C` – Date when status changed to Disqualified.  
- `DATE_STATUS_CUSTOMER_C` – Date when status changed to Customer.  
- `DATE_STATUS_SQL_C` – Date when status changed to SQL.  
- `PARTNER_ACCOUNT_C` – Identifier of the partner account.  
- `DISQUALIFIED_REASON_C` – Reason for disqualification.  
- `RECYCLED_REASON_C` – Reason for recycling.  
- `_FIVETRAN_SYNCED` – Flag indicating if the record has been synced.  
- `CONTACT_ID_HIDDEN_C` – Hidden contact identifier.  
- `OPPORTUNITYRELATEDWITH_QL_C` – Indicator of opportunity relation.  
- `_FIVETRAN_DELETED` – Flag indicating if the record has been deleted in Fivetran.  
- `LAST_TOUCH_MQL_C` – Indicator of last touch MQL.  
- `PRODUCTSOF_INTEREST_C` – Products of interest.  
- `PRIMARY_PRODUCTOF_INTEREST_C` – Primary product of interest.  
- `LAST_LEAD_SOURCE_C` – Last lead source.  
- `LAST_LEAD_SOURCE_DETAIL_C` – Detail of the last lead source.  
- `DBT_SCD_ID` – Slowly changing dimension identifier.  
- `DBT_UPDATED_AT` – Timestamp of the last DBT update.  
- `DBT_VALID_FROM` – Start of validity period for the record.  
- `DBT_VALID_TO` – End of validity period for the record.

## Logic Explanation  
1. **Source**: The query reads directly from the table `TRANSFORM_DEV.DBT_MAHMUDNABI_snapshots.sfdc_qualified_lead_snapshot`.  
2. **Selection**: All columns listed in the SELECT clause are retrieved without any transformation.  
3. **No Joins or Filters**: The query contains no JOINs, WHERE clauses, GROUP BY, or ORDER BY statements.  
4. **Result Set**: Each row in the result set corresponds to a single snapshot record of a qualified lead, preserving all source fields and SCD metadata.

## Grain of Data  
The data is at the **lead snapshot level**: one row per qualified lead record as captured in the snapshot table at a specific point in time.
